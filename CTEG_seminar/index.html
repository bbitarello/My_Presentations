<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>What drives the reduced prediction accuracy of polygenic scores in non-European individuals?</title>
    <meta charset="utf-8" />
    <meta name="author" content="Bárbara Domingues Bitarello" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">




class: inverse, center, middle

# .lilac[What drives the reduced prediction accuracy of polygenic scores in non-European individuals?]

### .lilac[Bárbara Domingues Bitarello]

### .lilac[Perelman School of Medicine, University of Pennsylvania]

???

Good afternoon everyone, or good evening depending on where you are.
Thank you, Debora, for this warm introduction. And thank you CTEG for inviting me to give this talk.

So today I am going to be talking about phenotype prediction using polygenic risk scores, and why they don't work well for any ancestry other than European and, for some traits, East Asian.

---
class: center, top
##**Many** variants

.pull-left[
&lt;img src="tam_et_al_2019.png" width="500px" /&gt;
]



???
Two decades of genomewide association studies, or GWAS, have shown us that most genetically inherited traits are highly polygenic. This means that they dozens, or hundreds or thousands of variants contribute to the trait
---
class: center, top
##**Many** variants with **small** effect size

.pull-left[.full-width[
&lt;img src="tam_et_al_2019.png" width="500px" /&gt;
]]


.pull-right[.full-width[
&lt;img src="tam_et_al_2019_2.png" width="600px" /&gt;
]]


[Tam et al. (2019) *Nat Rev Genet*]

???
Also, these variants are largely small in their reffect size.
This results in the landscape of polygenic traits to look something like we see on the right: GWAS are mostly successful at capturing variants between these two diagonal lines: common, with moderate or small effect variants, and some rare but highly penetrant mutations, that is, that have a considerable effect size.
Rare variants with small effect sizes are difficult to identify using GWAS, and common variants with large effects are unusual for common complex diseases
---
class: inverse, center, middle
# .lilac[Combined, they explain a lot!]
???

So although most of these variants we detect in genome-wide association studies have very small effect, when you add them up, they explain quite a lot of the variation in a trait.
---
class: middle, center
# Some examples


|Phenotype                    |Statistic | Value| Variants|
|:----------------------------|:---------|-----:|--------:|
|height                       |R-squared |  25.0|     3000|
|schizophrenia                |R-squared |   7.0|      100|
|ADHD                         |R-squared |   5.5|      100|
|breast cancer                |AUC       |  60.0|     1000|
|cardiovascular disease (CAD) |AUC       |  81.0|     6000|
--


### PS: In **Europeans...**

???

To mention a few example, height is one of the most well-studied and most polygenic traits we know of. So far more than 3,000 independently associated variants have been uncovered through GWAS and together they explain about 25% of variation in height as show by linear regression models. For schizophrenia and ADHD, those values are between 5.5-7%. That might seem low, but actually it isn't if you think about this...
---
class: center, top

## Polygenic risk scores add up those small effects
.pull-left[.full-width[
&lt;img src="gwas_schema_pasaniuc_price.png" width="650px" /&gt;

.small[Pasaniuc &amp; Price (2017), *Nat Rev Genet*]


]]

.pull-right[.full-width[




`$$PRS=\sum_{i=1}^{m} \hat\beta_{i} G_{j,i}$$` 


`\(\hat\beta\)` : effect size (from GWAS)

`\(G\)` : Effect allele dosage

`\(j\)`: Individuals

`\(i\)`: SNPs

**independence**

**additive model**

]]


???
So you did a GWAS for height. Then, for each variant in the genome you have something like this: the genotype in that locus has an effect on height, and can be modelled as a linear relationship. So you have an effect size for one allele in that locus, which is a correlation between the phenotype and the genotype. 

Then you make some assumptions about independence of these loci and that an additive model is appropriate and you have this polygenic score, which is a weighted sum of the genotypes in an individuals. Weighted by the effect sizes.
---
class: top, center
# PRSs are appealing

.pull-left[.full-width[
## **easy**

## **promising**

## **fast**

## **minimal requirements**
]]
.pull-right[.full-width[
&lt;img src="cad.png" width="460px" /&gt;
[Khera et al (2018) Nat Genet]
]]

???
So as you can see from this, PRS are very appealing...They are easy and simple to implement, all you need are some summary statistics from a GWAS, and no further complicated modeling.

Here is one promising example. The x axis shows the percentile of polygenic score. And the y axis shows the pravalence of CAD. IF we look at the highest bins of PRS, prevalance of CAD is 10%. These individuals have a 8-fold increase of CAD compared to the rest of the population. This makes the PRS able to find 20-fold mroe people at risk for CAD than if you were simply testing for large effect mutations, which have large effect but are rare.
There are a few other examples like this sofar for breast cancer for instance.
The main point I want to emphasize is...This is for individuals with European ancestry.

---
class: middle, center, inverse

# .lilac[What about ancestry?]

???
right. So what about ancestry?
---
class: center, top
.pull-left[.full-width[
## Europeans represent almost 80% of GWAS participants...
&lt;img src="Screen Shot 2020-09-16 at 4.28.04 PM.png" width="350px" /&gt;

[Sirugo, Williams &amp; Tishkoff (2019) *Cell*]]]
--
.pull-left[.full-width[

&lt;img src="index_files/figure-html/unnamed-chunk-8-1.png" width="420px" /&gt;

[Data: https://worldpopulationreview.com/]

## .. and 10% of the world's population
]]

???
Ok, so let's look at this pie chart from last year, with the proportion of individuals from Each of these groups of ancestry that appear in GWAS. Europeans make up almost 80%, Asians about 20% and Africans about 2%. Note that this is a big improvement since 2009. The same survey in 2009 showed that 96% of individuals were European!

Anyway, now look at this pie chart on the right, which I made from data from worldpopulationreview for 2020. Now, the colors are not a true match, but I did my best. BEar in mind that the plot on the left is about ancestry, and the one on the right is about continents, regardless of ancestry. Nevertheless, it's a reasonable approximation for this purpose. Europeans in Blue represent a disproportionate amount of GWAS participants especially if you consider their share of the world's population. Asian POPULATION represent 60% of the world and ASIAN ANCESTRY only 10% of GWAS, and African POPULATION 17 and AND AFRICAN ANCESTRY 2%. Not to mention the other ancestries which are virtually non-existent.
---
class: center, middle, inverse
# .lilac[How does PRS accuracy transfer across ancestries?]

???
this is obviously not ideal and reflects many biases which I don't have time to go into to, but considering the hype i showed about PRS before, how does this affect popygenic risk score predictions?
---
class: center, top
### PRS accuracy decreases with genetic distance from Europeans

&lt;img src="Screen Shot 2020-09-16 at 10.26.28 PM.png" width="690px" /&gt;

[Martin et al. (2019) *Nat Genet*]

???
Over the past two years or so a few papers have come out showing that prediction accuracy from PRS decreases with genetic distance from Europeans.
This figure from Martin et al showes average prediction accuracies for 17 traits, using GWAS summary statisticas derived from 100% European cohorts. I am not sure what american means?
---
class: top,center

### PRS accuracy decreases with genetic distance from Europeans
&lt;img src="fig1.png" width="670px" /&gt;

[Wang &amp; Wisscher (2020) *Nat Comms*]

####LOA: loss of accuracy
???
And wang &amp; wisscher recently showed through simulations tat this is expected. On the x axis here you have south asians, east asians and africans, and they axis shows the reltive accuracy, i.e, divided by Eur accuracy. It's expected to decline under a range of genetic architectures. I won't go into this but the different colors here represent different estimators they used. 
For the remainder of this talk I will use LOA to refer to this loss of accuracy
#---
#class: middle, center, inverse


## .lilac[This had been known way before human geneticists became interested!]


#![](scutari2003.png)

### .lilac[*2003*]
---
class: middle, center, inverse


## .lilac[Why is this loss of prediction observed?]
--

##.lilac[What] can *we do* .lilac[about it?]

???
What about empirically? What does this look like?
Ideally, we would have diverse GWAS, so that phenotypic prediction would be informed by ancestry background. But as I showed, that's far from being the case. So what can we do.
---

class: top, center


## Many factors may influence **LOA**
.pull-left[.full-width[

 causal variants 



 local selection



 gene-gene interactions


 gene-environment interactions
]]
.pull-right[.full-width[



 **marginal effect sizes**



 **LD **


 **site frequency spectrum **


**phenotypic variance**


]]

???
Many factors can affect PRS prediction accuracy. Causal variants might actually differ to some extent accross ancestries. There might have been local selection in some populations but not others. There might be population-specifc gene-gene and gene-E interactions.

Also, marginal effect sizes might differ for a number of reasons, and we know that LD patters and SFS patterns differ across ancestries and can impact this RA. Finally, phenotypic variance might actually differ. So in my work taht I am about to show you, I explored these factors highlighted here.
--

###These factors are not mutually exclusive!

---
class: inverse, middle, center
# .lilac[Questions]

### How do these .lilac[different factors] affect prediction accuracy?
### Can we .lilac[leverage ancestry] into the PRS and improve predictions?

???
So the quesitons that motivated this work were:
---
class: middle, center

#Let's look at height
???
We chose to look at height in individuals with Eur, afr and admixed ancestry.
---
class:  top, center
##Ancestry as a **continuous** variable

.pull-left[.full-width[

#### highly polygenic

#### many cohorts phenotyped

#### large GWAS (UKBB] `\(\sim\)` 360,000 **Europeans**)

`\(height\sim Sex+Age+ Age^2+p_{eur}\)`

`\(height\sim Sex+Age+ Age^2+p_{eur}+PRS\)`
]

.pull-right[.full-width[
#### European + African ancestry


&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Data &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Ancestry &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; N &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Number_SNPs &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; UKBB_eur &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; European &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9998 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 685475 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; HRS_EUR &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; European &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10159 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1511742 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; UKBB_afr &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; African + European &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8700 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 685475 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; WHI_afr &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; African American &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6863 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 741983 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; JHS_afr &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; African American &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1773 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 702685 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; HRS_afr &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; African American &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2251 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1511742 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

.small[Bitarello &amp; Mathieson (2020), *G3*]
]]
???
why height? It's a somehwat well-udnerstood trait. it's hgihly popygenic and easy to measure. It is highly heritable (80% based ont twin studies, about 50% based on SNP heritability)

So in this work we used GWAS summary statistics for height from a cohort of 360K europeans from the UK biobank. And we verified how well we could predicti height in individuals with different degrees of african ancestry.

Importantly, unlike most studies, we consdierted ancestry as a continuous variable. So each individuals we analysed had a "proportion of Eur ancestry" inferred by local ancestry inference and averaged across the genome.

In the end we looked at about 19,000 individuals with admied ancestry, and 10,000 with eur ancestry from different cohorts.

we modell height as a function of sex age and eur ancesty and compare that to a mdoel that also includes prs.
---
class: top, center
###PRS accuracy **increases** with proportion of European ancestry

&lt;img src="Fig1a.png" width="670px" /&gt;


.small[Bitarello &amp; Mathieson (2020), *G3*]
---
class: top, center

###GWAS from UKBB (AFR) individuals

.pull-left[.full-width[
&lt;img src="Fig3c.png" width="670px" /&gt;

]]


.pull-right[.full-width[

`\(y=sex+age+age^2+10PCs\)`

`\(N_{AFR}\sim8,800\)`

`\(N_{EUR}\sim350,000\)`

`$$\chi_{diff}^2=\left[\frac{\beta_{eur}-\beta_{afr}}{\sqrt{SE_{eur}^2+SE_{afr}^2}}\right]^2$$`
]]

.small[Bitarello &amp; Mathieson (2020), *G3*]

---
class: top, center
###Using only EUR chunks of each genome
.pull-left[.full-width[
&lt;img src="Fig1b.png" width="670px" /&gt;
.small[Bitarello &amp; Mathieson (2020), *G3*]
]]

.pull-right[.full-width[

`$$y=0.15p_{eur}^k$$`

`\(k=1\)` 

all predictive power comes from European chunks


`\(k=2\)`

predictive power is uniformly distributed across the genome
]]


### **Surprisingly, this relationship seems to be more like k=2**

???
In both scenarios, mroe Eur ancestry means more data, so of course prediction increases, but while kappa=1 entails that it is the EUr chunks themselves that contribute to this, kappa=2 entails that 
---
class: top, center
### Allele frequency differences explain up to **20%** of **LOA**

.pull-left[.full-width[
&lt;img src="Fig4c.png" width="370px" /&gt;
]]
.pull-right[.full-width[
**Additive genetic variance**
`$$G_{PRS}=\frac{\sum2f_{i_afr}(1-f_{i, afr})\beta_{i,eur}^2}{\sum2f_{i,eur}(1-f_{i,eur})\beta_{i,eur}^2}$$`

]]

Bitarello &amp; Mathieson (2020), *G3*
---
class: top, center

###**Prediction:** variance in phenotype lower in EUR

--
.pull-left[.full-width[
genome-wide genetic variance in EUR is `\(\sim 76\%\)` of that in AFR

`$$height\sim Sex+Age+ Age^2+p_{eur}$$`

Variable variance model:
`$$y=\mu+\beta p_{j, eur}+\epsilon; \epsilon_{j}\sim N(0,\delta ^2  + \gamma p_{j, eur})$$`

####.gray[Mean+1 1sd, constant variance]

####.green[fitted, variable variance]

####.orange[model, variance in phenotypic variance is 100% in AFR and 76% in EUR]
]]


.pull-right[.full-width[
&lt;img src="FigureS13.png" width="390px" /&gt;

[Bitarello &amp; Mathieson (2020), *G3*]
]]

--
###**Observation:** Phenotypic variance does not change with ancestry
???
Gray lines show mean height, and dashed lines show ∓1 sd. In orange, we show the expected sd if it were negatively dependent on European ancestry. In green, we show the fitted model with variable variance, which is not significantly different from the constant variance model (gray). We reject the model (orange line) whereby the phenotypic variance in people with 100% European ancestry is 76% that of people with 0% European ancestry.
---
class: top, center
### Differences in linkage disequilibrium

&lt;img src="LD_SCHEMA.png" width="670px" /&gt;


---
class: top, center
### **Prediction:** better tagging of causal variants decreases **LOA**
--

&lt;img src="Fig4a.png" width="570px" /&gt;

[Bitarello &amp; Mathieson (2020), *G3*]

### **Observation:** Imputation doesn't influence **LOA**
---
class: top, left
### **Prediction 1:** LOA is **independent** of LD differences

`$$Rel_{R2}=\frac{R^2_{bin}}{R^2_{total}}$$`

.pull-left[.fix-width[
&lt;img src="LD_cartoon.001.jpeg" width="700px" /&gt;
]]
.pull-right[.fix-width[
&lt;img src="LD_cartoon.002.jpeg" width="700px" /&gt;
]]
###**Similar** slopes

---
class: top, left
### **Prediction 2:** LOA is **dependent** of LD differences

`$$Rel_{R2}=\frac{R^2_{bin}}{R^2_{total}}$$`

.pull-left[.fix-width[
&lt;img src="LD_cartoon2.001.jpeg" width="600px" /&gt;
]]
.pull-right[.fix-width[
&lt;img src="LD_cartoon2.002.jpeg" width="600px" /&gt;
]]
###**Different** slopes

---
class: top, center

.pull-left[

`$$Rel_{R2}=\frac{R^2_{bin}}{R^2_{total}}$$`
]

.pull-right[.fix-width[

&lt;img src="Fig3b.png" width="500px" /&gt;
####Recombination Rate

[Bitarello &amp; Mathieson (2020), *G3*]
]]

###**Observation:** LOA is **somewhat** dependent on recombination rate

---
class: top, left
###**Prediction:** Differences in effect sizes depend on allele frequency differences
 
.pull-left[.full-width[
&lt;img src="Fig5b.png" width="630px" /&gt;
[Bitarello &amp; Mathieson (2020), *G3*]
]]
.pull-right[.full-width[

`\(N_{AFR}\sim8,800\)`

`\(N_{EUR}\sim350,000\)`

`$$\chi_{diff}^2=\left[\frac{\beta_{eur}-\beta_{afr}}{\sqrt{SE_{eur}^2+SE_{afr}^2}}\right]^2$$`
]]


###**Observation:** Difference in effect sizes **increase** with allele frequency differences across ancestries
---
class: center
###*Assuming* there **are** differences in **marginal** effect sizes



---
class: center
###*Assuming* there **are** differences in **marginal** effect sizes

`$$PRS_1^{C}=\alpha PRS_{AFR}+(1-\alpha) PRS_{EUR}$$`
Marquez-Luna *et al.* (2018) *Genet Epidem*

--



`$$PRS_2^{C}=\alpha(1-p_{eur,j}) PRS_{afr,j}+(1-\alpha+\alpha p_{eur,j}) PRS_{EUR}$$`
Bitarello &amp; Mathieson (2020), *G3*
--

`$$PRS_3^{C}= \alpha\left[\sum_{i\in AFR}\beta_{i, afr} G_{i}\right]+(1-\alpha)\left[\sum_{i\in AFR}\beta_{i, eur} G_{i}\right]+\left[\sum_{i\in EUR}\beta_{i, eur} G_{i}\right]$$`
Bitarello &amp; Mathieson (2020), *G3*
---
class:left
###**Prediction:** Including ancestry-specific effect sizes improves accuracy for admixed individuals

.center[
&lt;img src="Fig2.png" width="630px" /&gt;

[Bitarello &amp; Mathieson (2020), *G3*]


]
###**Observation:** Modest improvement 
---
class:left, top
##.lilac[Take Home Messages]

--

* LD and SFS contribute to **LOA** across ancestries

--

* not enough to explain entire **LOA**

--

* marginal effect sizes differences occur

--

* better testing with larger NEA sample sizes

--

**Future work**

* optimizing ancestry-sensitive approach

--

* explore ancestry-dependent gene-gene interactions

--

* include more co-variates?

???
Marginal effect size results suggest there might be something worth looking into there. Perhaps local epistasis or other population-specific phenomena.
---
class: top, center
# Acknowledgements

.pull-left[.full-width[

**Iain Mathieson**

Neale Lab

UK Biobank

Women's Health Initiative

Jackson Heart Study

Health and Retirement Study

&lt;img src="kaufman-logo-tag.png" width="350px" /&gt;

]]
.pull-right[.full-width[


&lt;img src="PerelmanSchoolofMedicineLogoVertical.png" width="170px" /&gt;

&lt;img src="tpf_logo_rgb-Facebook.jpg" width="210px" /&gt;



&lt;img src="NIGMS_logo.jpg" width="120px" /&gt;
]]

---

class: inverse,center, middle

# .lilac[Thank you!]

# .lilac[Questions?]




    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
